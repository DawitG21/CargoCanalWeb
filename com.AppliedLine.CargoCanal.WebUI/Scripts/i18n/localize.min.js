(function(){"use strict";angular.module("localization",[]).factory("localize",["$http","$rootScope","$window","$filter",function(n,t,i,r){var u={language:"",dictionary:[],url:undefined,resourceFileLoaded:!1,successCallback:function(n){u.dictionary=n;u.resourceFileLoaded=!0;t.$broadcast("localizeResourcesUpdated")},setLanguage:function(n){u.language=n;u.initLocalizedResources()},setUrl:function(n){u.url=n;u.initLocalizedResources()},buildUrl:function(){if(!u.language){var n,t;n=i.navigator&&i.navigator.userAgent&&(t=i.navigator.userAgent.match(/android.*\W(\w\w)-(\w\w)\W/i))?t[1]:i.navigator.userLanguage||i.navigator.language;u.language=n}return"src/assets/i18n/resources-locale_"+u.language+".json"},initLocalizedResources:function(){var t=u.url||u.buildUrl();n({method:"GET",url:t,cache:!1}).then(u.successCallback,function(){n({method:"GET",url:"src/assets/i18n/resources-locale_default.json",cache:!1}).then(u.successCallback)})},getLocalizedString:function(n){var i="",t;return u.dictionary!==[]&&u.dictionary.data&&u.dictionary.data.length>0&&(t=r("filter")(u.dictionary.data,function(t){return t.key===n})[0],t!=undefined&&(i=t.value)),i}};return u}]).filter("i18n",["localize",function(n){return function(t){return n.getLocalizedString(t)}}]).directive("i18n",["localize",function(n){var t={restrict:"EAC",updateText:function(t,i){var u=i.split("|"),r,f,e;if(u.length>=1&&(r=n.getLocalizedString(u[0]),r!==null&&r!==undefined&&r!=="")){if(u.length>1)for(f=1;f<u.length;f++)e="{"+(f-1)+"}",r=r.replace(e,u[f]);t.text(r)}},link:function(n,i,r){n.$on("localizeResourcesUpdated",function(){t.updateText(i,r.i18n)});r.$observe("i18n",function(){t.updateText(i,r.i18n)})}};return t}]).directive("i18nAttr",["localize",function(n){var t={restrict:"EAC",updateText:function(t,i){var u=i.split("|"),r=n.getLocalizedString(u[0]),f,e;if(r!==null&&r!==undefined&&r!==""){if(u.length>2)for(f=2;f<u.length;f++)e="{"+(f-2)+"}",r=r.replace(e,u[f]);t.attr(u[1],r)}},link:function(n,i,r){n.$on("localizeResourcesUpdated",function(){t.updateText(i,r.i18nAttr)});r.$observe("i18nAttr",function(n){t.updateText(i,n)})}};return t}])})();